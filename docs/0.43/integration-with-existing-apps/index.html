<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>嵌入到现有原生应用 · React Native 中文网</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;div class=&quot;integration-toggler&quot;&gt;"/><meta name="docsearch:version" content="0.43"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="嵌入到现有原生应用 · React Native 中文网"/><meta property="og:type" content="website"/><meta property="og:url" content="https://reactnativecn.github.io/react-native-website/"/><meta property="og:description" content="&lt;div class=&quot;integration-toggler&quot;&gt;"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/react-native-website/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/highlight.js@9.18.1/styles/solarized-dark.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-63485149-4', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/focus-visible@5.0.2/dist/focus-visible.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/reactnativecn/react-native-website@production/cnwebsite/static/js/codeblocks.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/reactnativecn/react-native-website@production/cnwebsite/static/js/tabs.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/reactnativecn/react-native-website@production/cnwebsite/static/js/doccode.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="https://cdn.jsdelivr.net/gh/facebook/docusaurus@1.14.4/packages/docusaurus-1.x/lib/static/js/scrollSpy.js"></script><link rel="stylesheet" href="/react-native-website/css/main.css"/><script src="https://cdn.jsdelivr.net/gh/facebook/docusaurus@1.14.4/packages/docusaurus-1.x/lib/static/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/react-native-website/"><img class="logo" src="/react-native-website/img/header_logo.svg" alt="React Native 中文网"/><h2 class="headerTitleWithLogo">React Native 中文网</h2></a><a href="/react-native-website/versions"><h3>0.43</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/react-native-website/docs/0.43/getting-started" target="_self">文档</a></li><li class="siteNavGroupActive"><a href="/react-native-website/docs/0.43/activityindicator" target="_self">API</a></li><li class=""><a href="//github.com/reactnativecn/react-native-website/issues" target="_blank">讨论</a></li><li class=""><a href="//update.reactnative.cn" target="_blank">热更新</a></li><li class=""><a href="/react-native-website/about" target="_self">关于</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/facebook/react-native" target="_self">GitHub</a></li><li class=""><a href="//zh-hans.reactjs.org/" target="_blank">React</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>进阶指南</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">入门基础<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/getting-started">搭建开发环境</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/tutorial">编写Hello World</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/props">Props（属性）</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/state">State（状态）</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/style">样式</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/height-and-width">高度与宽度</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/layout-with-flexbox">使用Flexbox布局</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/handling-text-input">处理文本输入</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/using-a-scrollview">如何使用ScrollView</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/using-a-listview">如何使用ListView</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/network">网络</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/more-resources">其他参考资源</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">进阶指南<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem navListItemActive"><a class="navItem" href="/react-native-website/docs/0.43/integration-with-existing-apps">嵌入到现有原生应用</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/colors">颜色</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/images">图片</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/handling-touches">处理触摸事件</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/animations">动画</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/accessibility">无障碍功能</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/timers">定时器</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/direct-manipulation">直接操作</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/debugging">调试</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/testing">自动化测试</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/javascript-environment">JavaScript环境</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/navigation">导航器对比</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/performance">性能</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/upgrading">升级</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/platform-specific-code">特定平台代码</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/gesture-responder-system">手势响应系统</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">使用指南(iOS)<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/native-modules-ios">原生模块</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/native-component-ios">原生UI组件</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/linking-libraries-ios">链接原生库</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/running-on-device-ios">在设备上运行</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/running-on-simulator-ios">在模拟器上运行</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/communication-ios">在原生和React Native间通信</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">使用指南(Android)<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/native-modules-android">原生模块</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/native-component-android">原生UI组件</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/headless-js-android">Headless JS（后台任务）</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/running-on-device-android">在设备上运行</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/signed-apk-android">打包APK</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/android-ui-performance">调试Android UI性能</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/android-building-from-source">从源代码编译React Native</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">组件<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/activityindicator">ActivityIndicator</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/button">Button</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/datepickerios">DatePickerIOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/drawerlayoutandroid">DrawerLayoutAndroid</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/flatlist">FlatList</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/image">Image</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/keyboardavoidingview">KeyboardAvoidingView</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/listview">ListView</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/listviewdatasource">ListView.DataSource</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/modal">Modal</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/navigator">Navigator</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/navigatorios">NavigatorIOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/picker">Picker</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/pickerios">PickerIOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/progressbarandroid">ProgressBarAndroid</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/progressviewios">ProgressViewIOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/refreshcontrol">RefreshControl</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/scrollview">ScrollView</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/sectionlist">SectionList</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/segmentedcontrolios">SegmentedControlIOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/slider">Slider</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/statusbar">StatusBar</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/switch">Switch</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/tabbarios">TabBarIOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/tabbarios-item">TabBarIOS.Item</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/text">Text</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/textinput">TextInput</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/toolbarandroid">ToolbarAndroid</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/touchablehighlight">TouchableHighlight</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/touchablenativefeedback">TouchableNativeFeedback</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/touchableopacity">TouchableOpacity</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/touchablewithoutfeedback">TouchableWithoutFeedback</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/view">View</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/viewpagerandroid">ViewPagerAndroid</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/virtualizedlist">VirtualizedList</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/webview">WebView</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">API<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/actionsheetios">ActionSheetIOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/adsupportios">AdSupportIOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/alert">Alert</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/alertios">AlertIOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/animated">Animated</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/appregistry">AppRegistry</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/appstate">AppState</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/asyncstorage">AsyncStorage</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/backandroid">BackAndroid</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/cameraroll">CameraRoll</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/clipboard">Clipboard</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/datepickerandroid">DatePickerAndroid</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/dimensions">Dimensions</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/easing">Easing</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/geolocation">Geolocation</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/imageeditor">ImageEditor</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/imagepickerios">ImagePickerIOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/imagestore">ImageStore</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/interactionmanager">InteractionManager</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/keyboard">Keyboard</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/layoutanimation">LayoutAnimation</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/linking">Linking</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/nativemethodsmixin">NativeMethodsMixin</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/netinfo">NetInfo</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/panresponder">PanResponder</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/permissionsandroid">PermissionsAndroid</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/pixelratio">PixelRatio</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/pushnotificationios">PushNotificationIOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/share">Share</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/stylesheet">StyleSheet</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/systrace">Systrace</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/timepickerandroid">TimePickerAndroid</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/toastandroid">ToastAndroid</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/vibration">Vibration</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/layout-props">布局样式属性</a></li><li class="navListItem"><a class="navItem" href="/react-native-website/docs/0.43/shadow-props">阴影样式属性</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="//github.com/reactnativecn/react-native-website/blob/production/cndocs/integration-with-existing-apps.md" target="_blank" rel="noreferrer noopener">帮助改进此文档</a><h1 id="__docusaurus" class="postHeaderTitle">嵌入到现有原生应用</h1></header><article><div><span><div class="integration-toggler">
<style>
.integration-toggler {
  margin-bottom: 10px;
}
.integration-toggler a {
  display: inline-block;
  padding: 10px 5px;
  margin: 2px;
  border: 1px solid #05A5D1;
  border-radius: 3px;
  text-decoration: none !important;
}
.display-platform-objc .integration-toggler .button-objc,
.display-platform-swift .integration-toggler .button-swift,
.display-platform-android .integration-toggler .button-android {
  background-color: #05A5D1;
  color: white;
}
.md-block { display: none; }
.md-block img { max-width:650px; }
.display-platform-objc .objc,
.display-platform-swift .swift,
.display-platform-android .android {
  display: block;
}
</style>
<span>平台:</span>
<a class="button-objc" onclick="display('platform', 'objc')">Objective-C</a>
<a class="button-swift" onclick="display('platform', 'swift')">Swift</a>
<a class="button-android" onclick="display('platform', 'android')">Android</a>
</div>
<div markdown class="md-block objc swift android">
<h2><a class="anchor" aria-hidden="true" id="核心概念"></a><a href="#核心概念" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>核心概念</h2>
<p>如果你正准备从头开始制作一个新的应用，那么 React Native 会是个非常好的选择。但如果你只想给现有的原生应用中添加一两个视图或是业务流程，React Native 也同样不在话下。只需简单几步，你就可以给原有应用加上新的基于 React Native 的特性、画面和视图等。</p>
</div>
<div markdown class="md-block objc swift">
<p>把 React Native 组件植入到 iOS 应用中有如下几个主要步骤：</p>
<ol>
<li>首先当然要了解你要植入的 React Native 组件。</li>
<li>创建一个<code>Podfile</code>，在其中以<code>subspec</code>的形式填写所有你要植入的 React Native 的组件。</li>
<li>创建 js 文件，编写 React Native 组件的 js 代码。</li>
<li>添加一个事件处理函数，用于创建一个<code>RCTRootView</code>。这个<code>RCTRootView</code>正是用来承载你的 React Native 组件的，而且它必须对应你在<code>index.ios.js</code>中使用<code>AppRegistry</code>注册的模块名字。</li>
<li>启动 React Native 的 Packager 服务，运行应用。</li>
<li>根据需要添加更多 React Native 的组件。</li>
<li><a href="debugging.html">调试</a>。</li>
<li>准备<a href="running-on-device-ios.html">部署发布</a> （比如可以利用<code>react-native-xcode.sh</code>脚本）。</li>
<li>发布应用，升职加薪，走向人生巅峰！😘</li>
</ol>
</div>
<div markdown class="md-block android">
<p>把 React Native 组件植入到 Android 应用中有如下几个主要步骤：</p>
<ol>
<li>首先当然要了解你要植入的 React Native 组件。</li>
<li>在 Android 项目根目录中使用 npm 来安装<code>react-native</code> ，这样同时会创建一个<code>node_modules/</code>的目录。</li>
<li>创建 js 文件，编写 React Native 组件的 js 代码。</li>
<li>在<code>build.gradle</code>文件中添加<code>com.facebook.react:react-native:+</code>，以及一个指向<code>node_nodules/</code>目录中的<code>react-native</code>预编译库的<code>maven</code>路径。</li>
<li>创建一个 React Native 专属的<code>Activity</code>，在其中再创建<code>ReactRootView</code>。</li>
<li>启动 React Native 的 Packager 服务，运行应用。</li>
<li>根据需要添加更多 React Native 的组件。</li>
<li>在真机上<a href="running-on-device-android.html">运行</a>、<a href="debugging.html">调试</a>。</li>
<li><a href="signed-apk-android.html">打包</a>。</li>
<li>发布应用，升职加薪，走向人生巅峰！😘</li>
</ol>
</div>
<div markdown class="md-block objc swift android">
<h2><a class="anchor" aria-hidden="true" id="开发环境准备"></a><a href="#开发环境准备" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>开发环境准备</h2>
</div>
<div markdown class="md-block android">
<p>首先按照<a href="getting-started.html">开发环境搭建教程</a>来安装 React Native 在安卓平台上所需的一切依赖软件（比如<code>npm</code>）。</p>
</div>
<div markdown class="md-block objc swift">
<h3><a class="anchor" aria-hidden="true" id="基础环境"></a><a href="#基础环境" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>基础环境</h3>
<p>首先按照<a href="getting-started.html">开发环境搭建教程</a>来安装 React Native 在 iOS 平台上所需的一切依赖软件（比如<code>npm</code>）。</p>
<h3><a class="anchor" aria-hidden="true" id="cocoapods"></a><a href="#cocoapods" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CocoaPods</h3>
<p><a href="http://cocoapods.org">CocoaPods</a>是针对 iOS 和 Mac 开发的包管理工具。我们用它来把 React Native 框架的代码下载下来并添加到你当前的项目中。</p>
<pre><code class="hljs css language-bash">$ sudo gem install cocoapods
</code></pre>
<blockquote>
<p>从技术上来讲，我们完全可以跳过 CocoaPods，但是这样一来我们就需要手工来完成很多配置项。CocoaPods 可以帮我们完成这些繁琐的工作。</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="示例-app"></a><a href="#示例-app" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>示例 App</h2>
</div>
<div markdown class="md-block objc">
<p>在本教程中我们用于<a href="https://github.com/JoelMarcey/iOS-2048">示范的 app</a>是一个[2048](<a href="https://en.wikipedia.org/wiki/2048_(video_game)类型的游戏">https://en.wikipedia.org/wiki/2048_(video_game)类型的游戏</a>。 下面是这个游戏还没有植入 React Native 时的主界面：</p>
</div>
<div markdown class="md-block swift">
<p>在本教程中我们用于<a href="https://github.com/JoelMarcey/swift-2048">示范的 app</a>是一个[2048](<a href="https://en.wikipedia.org/wiki/2048_(video_game)类型的游戏">https://en.wikipedia.org/wiki/2048_(video_game)类型的游戏</a>。下面是这个游戏还没有植入React Native 时的主界面：</p>
</div>
<div markdown class="md-block objc swift">
<p><img src="/img/react-native-existing-app-integration-ios-before.png" alt="Before RN Integration"></p>
<h2><a class="anchor" aria-hidden="true" id="依赖包"></a><a href="#依赖包" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>依赖包</h2>
<p>React Native 的植入过程同时需要 React 和 React Native 两个 node 依赖包。</p>
<h3><a class="anchor" aria-hidden="true" id="packagejson"></a><a href="#packagejson" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>package.json</code></h3>
<p>我们把具体的依赖包记录在<code>package.json</code>文件中。如果项目根目录中没有这个文件，那就自己创建一个。</p>
<blockquote>
<p>对于一个典型的 React Native 项目来说，一般<code>package.json</code>和<code>index.ios.js</code>等文件会放在项目的根目录下。而 iOS 相关的原生代码会放在一个名为<code>ios/</code>的子目录中,这里也同时放着你的 Xcode 项目文件（<code>.xcodeproj</code>）。</p>
</blockquote>
<p>下面是一个最简单的<code>package.json</code>的内容示例。</p>
<blockquote>
<p>示例中的<code>version</code>字段没有太大意义（除非你要把你的项目发布到 npm 仓库）。<code>scripts</code>中是用于启动 packager 服务的命令。<code>dependencies</code>中的 react 和 react-native 的版本取决于你的具体需求。一般来说我们推荐使用最新版本。你可以使用<code>npm info react</code>和<code>npm info react-native</code>来查看当前的最新版本。另外，react-native 对 react 的版本有严格要求，高于或低于某个范围都不可以。本文无法在这里列出所有 react native 和对应的 react 版本要求，只能提醒读者先尝试执行 npm install，然后注意观察安装过程中的报错信息，例如<code>require react@某.某.某版本, but none was installed</code>，然后根据这样的提示，执行<code>npm i -S react@某.某.某版本</code>。</p>
</blockquote>
</div><div markdown class="md-block objc">
<pre><code class="hljs css language-bash">{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"NumberTileGame"</span>,
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"0.0.1"</span>,
  <span class="hljs-string">"private"</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"start"</span>: <span class="hljs-string">"node node_modules/react-native/local-cli/cli.js start"</span>
  },
  <span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"react"</span>: <span class="hljs-string">"15.4.1"</span>,
    <span class="hljs-string">"react-native"</span>: <span class="hljs-string">"0.39.2"</span>
  }
}
</code></pre>
</div><div markdown class="md-block swift">
<pre><code class="hljs css language-bash">{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"swift-2048"</span>,
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"0.0.1"</span>,
  <span class="hljs-string">"private"</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"start"</span>: <span class="hljs-string">"node node_modules/react-native/local-cli/cli.js start"</span>
  },
  <span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"react"</span>: <span class="hljs-string">"15.4.1"</span>,
    <span class="hljs-string">"react-native"</span>: <span class="hljs-string">"0.39.2"</span>
  }
}
</code></pre>
</div><div markdown class="md-block objc swift">
<h3><a class="anchor" aria-hidden="true" id="安装依赖包"></a><a href="#安装依赖包" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>安装依赖包</h3>
<p>使用 npm（node 包管理器，Node package manager）来安装 React 和 React Native 模块。这些模块会被安装到项目根目录下的<code>node_modules/</code>目录中。
在包含有 package.json 文件的目录（一般也就是项目根目录）中运行下列命令来安装：</p>
<pre><code class="hljs css language-bash">$ npm install
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="react-native-框架"></a><a href="#react-native-框架" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React Native 框架</h2>
<p>React Native 框架整体是作为 node 模块安装到项目中的。下一步我们需要在 CocoaPods 的<code>Podfile</code>中指定我们所需要使用的组件。</p>
<h3><a class="anchor" aria-hidden="true" id="subspecs"></a><a href="#subspecs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Subspecs</h3>
<p>在你开始把 React Native 植入到你的应用中之前，首先要决定具体整合的是 React Native 框架中的哪些部分。而这就是<code>subspec</code>要做的工作。在创建<code>Podfile</code>文件的时候，需要指定具体安装哪些 React Native 的依赖库。所指定的每一个库就称为一个<code>subspec</code>。</p>
<p>可用的<code>subspec</code>都列在<a href="https://github.com/facebook/react-native/blob/master/React.podspec"><code>node_modules/react-native/React.podspec</code></a>中，基本都是按其功能命名的。一般来说你首先需要添加<code>Core</code>，这一<code>subspec</code>包含了必须的<code>AppRegistry</code>、<code>StyleSheet</code>、<code>View</code>以及其他的一些 React Native 核心库。如果你想使用 React Native 的<code>Text</code>库（即<code>&lt;Text&gt;</code>组件），那就需要添加<code>RCTText</code>的<code>subspec</code>。同理，<code>Image</code>需要加入<code>RCTImage</code>，等等。</p>
<h4><a class="anchor" aria-hidden="true" id="podfile"></a><a href="#podfile" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Podfile</h4>
<p>在 React 和 React Native 模块成功安装到<code>node_modules</code>目录之后，你就可以开始创建<code>Podfile</code>以便选择所需的组件安装到应用中。</p>
<p>创建<code>Podfile</code>的最简单的方式就是在 iOS 原生代码所在的目录中使用 CocoaPods 的<code>init</code>命令：</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment">## 在iOS原生代码所在的目录中（也就是`.xcodeproj`文件所在的目录）执行：</span>
$ pod init
</code></pre>
<p><code>Podfile</code>会创建在执行命令的目录中。你需要调整其内容以满足你的植入需求。调整后的<code>Podfile</code>的内容看起来类似下面这样：</p>
</div><div markdown class="md-block objc">
<pre><code class="hljs"><span class="hljs-comment"># target的名字一般与你的项目名字相同</span>
target <span class="hljs-string">'NumberTileGame'</span> <span class="hljs-keyword">do</span>

  <span class="hljs-comment"># 'node_modules'目录一般位于根目录中</span>
  <span class="hljs-comment"># 但是如果你的结构不同，那你就要根据实际路径修改下面的`:path`</span>
  pod <span class="hljs-string">'React'</span>, <span class="hljs-symbol">:path</span> =&gt; <span class="hljs-string">'../node_modules/react-native'</span>, <span class="hljs-symbol">:subspecs</span> =&gt; [
    <span class="hljs-string">'Core'</span>,
    <span class="hljs-string">'RCTText'</span>,
    <span class="hljs-string">'RCTNetwork'</span>,
    <span class="hljs-string">'RCTWebSocket'</span>, <span class="hljs-comment"># 这个模块是用于调试功能的</span>
    <span class="hljs-comment"># 在这里继续添加你所需要的模块</span>
  ]
  <span class="hljs-comment"># 如果你的RN版本 &gt;= 0.42.0，请加入下面这行</span>
  pod <span class="hljs-string">"Yoga"</span>, <span class="hljs-symbol">:path</span> =&gt; <span class="hljs-string">"../node_modules/react-native/ReactCommon/yoga"</span>

<span class="hljs-keyword">end</span>
</code></pre>
</div><div markdown class="md-block swift">
<pre><code class="hljs">source <span class="hljs-string">'https://github.com/CocoaPods/Specs.git'</span>

<span class="hljs-comment"># 对于Swift应用来说下面两句是必须的</span>
platform <span class="hljs-symbol">:ios</span>, <span class="hljs-string">'8.0'</span>
use_frameworks!

<span class="hljs-comment"># target的名字一般与你的项目名字相同</span>
target <span class="hljs-string">'swift-2048'</span> <span class="hljs-keyword">do</span>

  <span class="hljs-comment"># 'node_modules'目录一般位于根目录中</span>
  <span class="hljs-comment"># 但是如果你的结构不同，那你就要根据实际路径修改下面的`:path`</span>
  pod <span class="hljs-string">'React'</span>, <span class="hljs-symbol">:path</span> =&gt; <span class="hljs-string">'../node_modules/react-native'</span>, <span class="hljs-symbol">:subspecs</span> =&gt; [
    <span class="hljs-string">'Core'</span>,
    <span class="hljs-string">'RCTText'</span>,
    <span class="hljs-string">'RCTNetwork'</span>,
    <span class="hljs-string">'RCTWebSocket'</span>, <span class="hljs-comment"># 这个模块是用于调试功能的</span>
    <span class="hljs-comment"># 在这里继续添加你所需要的模块</span>
  ]
  <span class="hljs-comment"># 如果你的RN版本 &gt;= 0.42.0，请加入下面这行</span>
  pod <span class="hljs-string">"Yoga"</span>, <span class="hljs-symbol">:path</span> =&gt; <span class="hljs-string">"../node_modules/react-native/ReactCommon/yoga"</span>

<span class="hljs-keyword">end</span>
</code></pre>
</div><div markdown class="md-block objc swift">
<h4><a class="anchor" aria-hidden="true" id="pod-安装"></a><a href="#pod-安装" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Pod 安装</h4>
<p>创建好了<code>Podfile</code>后，就可以开始安装 React Native 的 pod 包了。</p>
<pre><code class="hljs css language-bash">$ pod install
</code></pre>
<p>然后你应该可以看到类似下面的输出(译注：同样由于众所周知的网络原因，pod install 的过程在国内非常不顺利，请自行配备稳定的翻墙工具，或是尝试一些<a href="https://www.baidu.com/s?ie=utf-8&amp;f=3&amp;rsv_bp=1&amp;ch=2&amp;tn=98010089_dg&amp;wd=cocoapods%20%E9%95%9C%E5%83%8F&amp;oq=cocoapods%E9%95%9C%E5%83%8F&amp;rsv_pq=8fe4602600052d40&amp;rsv_t=5d9fNEvNrqwcBS3rvMCKw0Cc%2FoW6XdW%2Bm4zks2nF3BxZ6cyWtJx1g%2F39Id6cUzeRTLM&amp;rqlang=cn&amp;rsv_enter=0&amp;inputT=809&amp;rsv_sug3=9&amp;rsv_sug1=7&amp;rsv_sug7=100&amp;prefixsug=cocoapods%20%E9%95%9C%E5%83%8F&amp;rsp=0&amp;rsv_sug4=1010">镜像源</a>)：</p>
<pre><code class="hljs css language-bash">Analyzing dependencies
Fetching podspec <span class="hljs-keyword">for</span> `React` from `../node_modules/react-native`
Downloading dependencies
Installing React (0.26.0)
Generating Pods project
Integrating client project
Sending stats
Pod installation complete! There are 3 dependencies from the Podfile and 1 total pod installed.
</code></pre>
</div><div markdown class="md-block swift">
<blockquote>
<p>如果你看到类似&quot;<em>The <code>swift-2048 [Debug]</code> target overrides the <code>FRAMEWORK_SEARCH_PATHS</code> build setting defined in <code>Pods/Target Support Files/Pods-swift-2048/Pods-swift-2048.debug.xcconfig</code>. This can lead to problems with the CocoaPods installation</em>&quot;的警告，请查看 Xcode 的<code>Build Settings</code>中的<code>Framework Search Paths</code>选项，确保其中的<code>Debug</code>和<code>Release</code>都只包含<code>$(inherited)</code>。</p>
</blockquote>
</div><div markdown class="md-block objc swift">
<h2><a class="anchor" aria-hidden="true" id="代码集成"></a><a href="#代码集成" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>代码集成</h2>
<p>现在我们已经准备好了所有依赖，可以开始着手修改原生代码来把 React Native 真正植入到应用中了。在我们的 2048 示例中，首先尝试添加一个显示有&quot;High Score&quot;（得分排行榜）的 React Native 页面。</p>
<h3><a class="anchor" aria-hidden="true" id="react-native-组件"></a><a href="#react-native-组件" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React Native 组件</h3>
<p>我们首先要写的是&quot;High Score&quot;（得分排行榜）的 JavaScript 端的代码。</p>
<h4><a class="anchor" aria-hidden="true" id="创建一个indexiosjs文件"></a><a href="#创建一个indexiosjs文件" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>创建一个<code>index.ios.js</code>文件</h4>
<p>首先创建一个空的<code>index.ios.js</code>文件。一般来说我们把它放置在项目根目录下。</p>
<blockquote>
<p><code>index.ios.js</code>是 React Native 应用在 iOS 上的入口文件。而且它是不可或缺的！它可以是个很简单的文件，简单到可以只包含一行<code>require/import</code>导入语句。本教程中为了简单示范，把全部的代码都写到了<code>index.ios.js</code>里（当然实际开发中我们并不推荐这样做）。</p>
</blockquote>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># 在项目根目录执行以下命令创建文件：</span>
$ touch index.ios.js
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="添加你自己的-react-native-代码"></a><a href="#添加你自己的-react-native-代码" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>添加你自己的 React Native 代码</h4>
<p>在<code>index.ios.js</code>中添加你自己的组件。这里我们只是简单的添加一个<code>&lt;Text&gt;</code>组件，然后用一个带有样式的<code>&lt;View&gt;</code>组件把它包起来。</p>
<pre><code class="hljs css language-js"><span class="hljs-meta">"use strict"</span>;

<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { AppRegistry, StyleSheet, Text, View } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-native"</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RNHighScores</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  render() {
    <span class="hljs-keyword">var</span> contents = <span class="hljs-keyword">this</span>.props[<span class="hljs-string">"scores"</span>].map(<span class="hljs-function"><span class="hljs-params">score</span> =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{score.name}</span>&gt;</span>
        {score.name}:{score.value}
        {"\n"}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span></span>
    ));
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.container}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.highScoresTitle}</span>&gt;</span>2048 High Scores!<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.scores}</span>&gt;</span>{contents}<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
    );
  }
}

<span class="hljs-keyword">const</span> styles = StyleSheet.create({
  <span class="hljs-attr">container</span>: {
    <span class="hljs-attr">flex</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">justifyContent</span>: <span class="hljs-string">"center"</span>,
    <span class="hljs-attr">alignItems</span>: <span class="hljs-string">"center"</span>,
    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">"#FFFFFF"</span>
  },
  <span class="hljs-attr">highScoresTitle</span>: {
    <span class="hljs-attr">fontSize</span>: <span class="hljs-number">20</span>,
    <span class="hljs-attr">textAlign</span>: <span class="hljs-string">"center"</span>,
    <span class="hljs-attr">margin</span>: <span class="hljs-number">10</span>
  },
  <span class="hljs-attr">scores</span>: {
    <span class="hljs-attr">textAlign</span>: <span class="hljs-string">"center"</span>,
    <span class="hljs-attr">color</span>: <span class="hljs-string">"#333333"</span>,
    <span class="hljs-attr">marginBottom</span>: <span class="hljs-number">5</span>
  }
});

<span class="hljs-comment">// 整体js模块的名称</span>
AppRegistry.registerComponent(<span class="hljs-string">"RNHighScores"</span>, () =&gt; RNHighScores);
</code></pre>
<blockquote>
<p><code>RNHighScores</code>是整体 js 模块（即你所有的 js 代码）的名称。你在 iOS 原生代码中添加 React Native 视图时会用到这个名称。</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="the-magic-rctrootview"></a><a href="#the-magic-rctrootview" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The Magic: <code>RCTRootView</code></h2>
<p>现在我们已经在<code>index.ios.js</code>中创建了 React Native 组件，下一步就是把这个组件添加给一个新的或已有的<code>ViewController</code>。 The easiest path to take is to optionally create an event path to your component and then add that component to an existing <code>ViewController</code>.</p>
<p>We will tie our React Native component with a new native view in the <code>ViewController</code> that will actually host it called <code>RCTRootView</code> .</p>
<h3><a class="anchor" aria-hidden="true" id="create-an-event-path"></a><a href="#create-an-event-path" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create an Event Path</h3>
<p>You can add a new link on the main game menu to go to the &quot;High Score&quot; React Native page.</p>
<p><img src="/img/react-native-add-react-native-integration-link.png" alt="Event Path"></p>
<h4><a class="anchor" aria-hidden="true" id="事件处理"></a><a href="#事件处理" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>事件处理</h4>
<p>We will now add an event handler from the menu link. A method will be added to the main <code>ViewController</code> of your application. This is where <code>RCTRootView</code> comes into play.</p>
<p>When you build a React Native application, you use the React Native packager to create an <code>index.ios.bundle</code> that will be served by the React Native server. Inside <code>index.ios.bundle</code> will be our <code>RNHighScore</code> module. So, we need to point our <code>RCTRootView</code> to the location of the <code>index.ios.bundle</code> resource (via <code>NSURL</code>) and tie it to the module.</p>
<p>We will, for debugging purposes, log that the event handler was invoked. Then, we will create a string with the location of our React Native code that exists inside the <code>index.ios.bundle</code>. Finally, we will create the main <code>RCTRootView</code>. Notice how we provide <code>RNHighScores</code> as the <code>moduleName</code> that we created <a href="#the-react-native-component">above</a> when writing the code for our React Native component.</p>
</div><div markdown class="md-block objc">
<p>首先导入<code>RCTRootView</code>的头文件。</p>
<pre><code class="hljs">#<span class="hljs-keyword">import</span> <span class="hljs-string">"RCTRootView.h"</span>
</code></pre>
<blockquote>
<p>这里的<code>initialProperties</code> are here for illustration purposes so we have some data for our high score screen. In our React Native component, we will use <code>this.props</code> to get access to that data.</p>
</blockquote>
<pre><code class="hljs">- (<span class="hljs-keyword">IBAction</span>)highScoreButtonPressed:(<span class="hljs-keyword">id</span>)sender {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"High Score Button Pressed"</span>);
    <span class="hljs-built_in">NSURL</span> *jsCodeLocation = [<span class="hljs-built_in">NSURL</span>
                             URLWithString:<span class="hljs-string">@"http://localhost:8081/index.ios.bundle?platform=ios"</span>];
    RCTRootView *rootView =
      [[RCTRootView alloc] initWithBundleURL : jsCodeLocation
                           moduleName        : <span class="hljs-string">@"RNHighScores"</span>
                           initialProperties :
                             @{
                               <span class="hljs-string">@"scores"</span> : @[
                                 @{
                                   <span class="hljs-string">@"name"</span> : <span class="hljs-string">@"Alex"</span>,
                                   <span class="hljs-string">@"value"</span>: <span class="hljs-string">@"42"</span>
                                  },
                                 @{
                                   <span class="hljs-string">@"name"</span> : <span class="hljs-string">@"Joel"</span>,
                                   <span class="hljs-string">@"value"</span>: <span class="hljs-string">@"10"</span>
                                 }
                               ]
                             }
                           launchOptions    : <span class="hljs-literal">nil</span>];
    <span class="hljs-built_in">UIViewController</span> *vc = [[<span class="hljs-built_in">UIViewController</span> alloc] init];
    vc.view = rootView;
    [<span class="hljs-keyword">self</span> presentViewController:vc animated:<span class="hljs-literal">YES</span> completion:<span class="hljs-literal">nil</span>];
}
</code></pre>
<blockquote>
<p>Note that <code>RCTRootView initWithURL</code> starts up a new JSC VM. To save resources and simplify the communication between RN views in different parts of your native app, you can have multiple views powered by React Native that are associated with a single JS runtime. To do that, instead of using <code>[RCTRootView alloc] initWithURL</code>, use <a href="https://github.com/facebook/react-native/blob/master/React/Base/RCTBridge.h#L93"><code>RCTBridge initWithBundleURL</code></a> to create a bridge and then use <code>RCTRootView initWithBridge</code>.</p>
</blockquote>
</div><div markdown class="md-block swift">
<p>首先<code>import</code>导入<code>React</code>库。</p>
<pre><code class="hljs"><span class="hljs-keyword">import</span> React
</code></pre>
<blockquote>
<p>The <code>initialProperties</code> are here for illustration purposes so we have some data for our high score screen. In our React Native component, we will use <code>this.props</code> to get access to that data.</p>
</blockquote>
<pre><code class="hljs"><span class="hljs-meta">@IBAction</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">highScoreButtonTapped</span><span class="hljs-params">(sender : UIButton)</span></span> {
  <span class="hljs-type">NSLog</span>(<span class="hljs-string">"Hello"</span>)
  <span class="hljs-keyword">let</span> jsCodeLocation = <span class="hljs-type">URL</span>(string: <span class="hljs-string">"http://localhost:8081/index.ios.bundle?platform=ios"</span>)
  <span class="hljs-keyword">let</span> mockData:<span class="hljs-type">NSDictionary</span> = [<span class="hljs-string">"scores"</span>:
      [
          [<span class="hljs-string">"name"</span>:<span class="hljs-string">"Alex"</span>, <span class="hljs-string">"value"</span>:<span class="hljs-string">"42"</span>],
          [<span class="hljs-string">"name"</span>:<span class="hljs-string">"Joel"</span>, <span class="hljs-string">"value"</span>:<span class="hljs-string">"10"</span>]
      ]
  ]

  <span class="hljs-keyword">let</span> rootView = <span class="hljs-type">RCTRootView</span>(
      bundleURL: jsCodeLocation,
      moduleName: <span class="hljs-string">"RNHighScores"</span>,
      initialProperties: mockData <span class="hljs-keyword">as</span> [<span class="hljs-type">NSObject</span> : <span class="hljs-type">AnyObject</span>],
      launchOptions: <span class="hljs-literal">nil</span>
  )
  <span class="hljs-keyword">let</span> vc = <span class="hljs-type">UIViewController</span>()
  vc.view = rootView
  <span class="hljs-keyword">self</span>.present(vc, animated: <span class="hljs-literal">true</span>, completion: <span class="hljs-literal">nil</span>)
}
</code></pre>
<blockquote>
<p>注意<code>RCTRootView bundleURL</code> starts up a new JSC VM. To save resources and simplify the communication between RN views in different parts of your native app, you can have multiple views powered by React Native that are associated with a single JS runtime. To do that, instead of using <code>RCTRootView bundleURL</code>, use <a href="https://github.com/facebook/react-native/blob/master/React/Base/RCTBridge.h#L93"><code>RCTBridge initWithBundleURL</code></a> to create a bridge and then use <code>RCTRootView initWithBridge</code>.</p>
</blockquote>
</div><div markdown class="md-block objc">
<blockquote>
<p>When moving your app to production, the <code>NSURL</code> can point to a pre-bundled file on disk via something like <code>[[NSBundle mainBundle] URLForResource:@&quot;main&quot; withExtension:@&quot;jsbundle&quot;];</code>. You can use the <code>react-native-xcode.sh</code> script in <code>node_modules/react-native/packager/</code> to generate that pre-bundled file.</p>
</blockquote>
</div><div markdown class="md-block swift">
<blockquote>
<p>When moving your app to production, the <code>NSURL</code> can point to a pre-bundled file on disk via something like <code>let mainBundle = NSBundle(URLForResource: &quot;main&quot; withExtension:&quot;jsbundle&quot;)</code>. You can use the <code>react-native-xcode.sh</code> script in <code>node_modules/react-native/packager/</code> to generate that pre-bundled file.</p>
</blockquote>
</div><div markdown class="md-block objc swift">
<h4><a class="anchor" aria-hidden="true" id="wire-up"></a><a href="#wire-up" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wire Up</h4>
<p>Wire up the new link in the main menu to the newly added event handler method.</p>
<p><img src="/img/react-native-add-react-native-integration-wire-up.png" alt="Event Path"></p>
<blockquote>
<p>One of the easier ways to do this is to open the view in the storyboard and right click on the new link. Select something such as the <code>Touch Up Inside</code> event, drag that to the storyboard and then select the created method from the list provided.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="测试植入结果"></a><a href="#测试植入结果" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试植入结果</h2>
<p>You have now done all the basic steps to integrate React Native with your current application. Now we will start the React Native packager to build the <code>index.ios.bundle</code> packager and the server running on <code>localhost</code> to serve it.</p>
<h3><a class="anchor" aria-hidden="true" id="app-transport-security"></a><a href="#app-transport-security" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>App Transport Security</h3>
<p>Apple has blocked implicit cleartext HTTP resource loading. So we need to add the following our project's <code>Info.plist</code> (or equivalent) file.</p>
<pre><code class="hljs css language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>NSAppTransportSecurity<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dict</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>NSExceptionDomains<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dict</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>localhost<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dict</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>NSTemporaryExceptionAllowsInsecureHTTPLoads<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">true</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dict</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dict</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dict</span>&gt;</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="运行-packager"></a><a href="#运行-packager" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>运行 Packager</h3>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># From the root of your project, where the `node_modules` directory is located.</span>
$ npm start
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="运行应用"></a><a href="#运行应用" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>运行应用</h3>
<p>如果你使用的是 Xcode，那么照常编译和运行应用即可。如果你没有使用 Xcode（但是你仍然必须安装 Xcode），则可以在命令行中使用以下命令来运行应用：</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># 在项目的根目录中执行：</span>
$ react-native run-ios
</code></pre>
<p>In our sample application, you should see the link to the &quot;High Scores&quot; and then when you click on that you will see the rendering of your React Native component.</p>
<p>Here is the <em>native</em> application home screen:</p>
<p><img src="/img/react-native-add-react-native-integration-example-home-screen.png" alt="Home Screen"></p>
<p>Here is the <em>React Native</em> high score screen:</p>
<p><img src="/img/react-native-add-react-native-integration-example-high-scores.png" alt="High Scores"></p>
<blockquote>
<p>If you are getting module resolution issues when running your application please see <a href="https://github.com/facebook/react-native/issues/4968">this GitHub issue</a> for information and possible resolution. <a href="https://github.com/facebook/react-native/issues/4968#issuecomment-220941717">This comment</a> seemed to be the latest possible resolution.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="看一下完整的代码变更"></a><a href="#看一下完整的代码变更" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>看一下完整的代码变更</h3>
</div><div markdown class="md-block objc">
<p>你可以在这个<a href="https://github.com/JoelMarcey/iOS-2048/commit/9ae70c7cdd53eb59f5f7c7daab382b0300ed3585">GitHub 提交记录</a>里查看一次完整的植入过程具体有哪些代码/文件变更。</p>
</div><div markdown class="md-block swift">
<p>你可以在这个<a href="https://github.com/JoelMarcey/swift-2048/commit/13272a31ee6dd46dc68b1dcf4eaf16c1a10f5229">GitHub 提交记录</a>里查看一次完整的植入过程具体有哪些代码/文件变更。</p>
</div><div markdown class="md-block android">
<h2><a class="anchor" aria-hidden="true" id="在应用中添加-js-代码"></a><a href="#在应用中添加-js-代码" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>在应用中添加 JS 代码</h2>
<p>在项目的根目录中运行：</p>
<pre><code class="hljs">$ npm init
$ npm install --save react react-native
$ curl -o .flowconfig https://raw.githubusercontent.com/facebook/react-native/master/.flowconfig
</code></pre>
<p><code>npm init</code>创建了一个空的 node 模块（其实就是创建了一个 package.json 描述文件），而<code>npm install</code>则创建了 node_modules 目录并把 react 和 react-native 下载到了其中。至于第三步 curl 命令，其实质是<code>下载</code>.flowconfig 配置文件，这个文件用于约束 js 代码的写法。这一步非必需，可跳过。下面我们打开新创建的<code>package.json</code>文件，然后在其<code>scripts</code>字段中加入:</p>
<pre><code class="hljs">&quot;start&quot;: &quot;node node_modules/react-native/local-cli/cli.js start&quot;
</code></pre>
<p>现在你的<code>package.json</code>内容应该类似这样：</p>
<pre><code class="hljs css language-bash">{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"NumberTileGame"</span>,
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"0.0.1"</span>,
  <span class="hljs-string">"private"</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"start"</span>: <span class="hljs-string">"node node_modules/react-native/local-cli/cli.js start"</span>
  },
  <span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"react"</span>: <span class="hljs-string">"15.4.1"</span>,
    <span class="hljs-string">"react-native"</span>: <span class="hljs-string">"0.39.2"</span>
  }
}
</code></pre>
<blockquote>
<p>示例中的<code>version</code>字段没有太大意义（除非你要把你的项目发布到 npm 仓库）。<code>scripts</code>中是用于启动 packager 服务的命令。<code>dependencies</code>中的 react 和 react-native 的版本取决于你的具体需求。一般来说我们推荐使用最新版本。你可以使用<code>npm info react</code>和<code>npm info react-native</code>来查看当前的最新版本。另外，react-native 对 react 的版本有严格要求，高于或低于某个范围都不可以。本文无法在这里列出所有 react native 和对应的 react 版本要求，只能提醒读者先尝试执行 npm install，然后注意观察安装过程中的报错信息，例如<code>require react@某.某.某版本, but none was installed</code>，然后根据这样的提示，执行<code>npm i -S react@某.某.某版本</code>。</p>
</blockquote>
<p>接下来在项目根目录中创建<code>index.android.js</code>文件，然后将下面的代码复制粘贴进来：</p>
<pre><code class="hljs css language-js"><span class="hljs-meta">"use strict"</span>;

<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { AppRegistry, StyleSheet, Text, View } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-native"</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloWorld</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.container}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.hello}</span>&gt;</span>Hello, World<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
    );
  }
}
<span class="hljs-keyword">var</span> styles = StyleSheet.create({
  <span class="hljs-attr">container</span>: {
    <span class="hljs-attr">flex</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">justifyContent</span>: <span class="hljs-string">"center"</span>
  },
  <span class="hljs-attr">hello</span>: {
    <span class="hljs-attr">fontSize</span>: <span class="hljs-number">20</span>,
    <span class="hljs-attr">textAlign</span>: <span class="hljs-string">"center"</span>,
    <span class="hljs-attr">margin</span>: <span class="hljs-number">10</span>
  }
});

AppRegistry.registerComponent(<span class="hljs-string">"HelloWorld"</span>, () =&gt; HelloWorld);
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="准备工作"></a><a href="#准备工作" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>准备工作</h2>
<p>在你的 app 中 <code>build.gradle</code> 文件中添加 React Native 依赖:</p>
<pre><code class="hljs"> <span class="hljs-keyword">dependencies</span> {
     ...
     <span class="hljs-keyword">compile</span> <span class="hljs-string">"com.facebook.react:react-native:+"</span> <span class="hljs-comment">// From node_modules.</span>
 }
</code></pre>
<blockquote>
<p>你想要指定构建时的 React Native 版本，请用 <code>npm</code> 已下载的本地 React Native 的版本号替换 <code>+</code> 。</p>
</blockquote>
<p>在项目的 <code>build.gradle</code> 文件中为 React Native 添加一个 maven 依赖的入口，必须写在 &quot;allprojects&quot; 代码块中:</p>
<pre><code class="hljs"><span class="hljs-class">allprojects </span>{
    <span class="hljs-class">repositories </span>{
        ...
        <span class="hljs-class">maven </span>{
            <span class="hljs-comment">// All of React Native (JS, Android binaries) is installed from npm</span>
            url <span class="hljs-string">"$rootDir/../node_modules/react-native/android"</span>
        }
    }
    ...
}
</code></pre>
<blockquote>
<p>确保依赖路径的正确！以免在 Android Studio 运行 Gradle 同步构建时抛出 “Failed to resolve: com.facebook.react:react-native:0.x.x&quot; 异常。</p>
</blockquote>
<p>接着，在 <code>AndroidManifest.xml</code> 清单文件中声明网络权限:</p>
<pre><code class="hljs">&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;
</code></pre>
<p>如果需要访问 <code>DevSettingsActivity</code> 界面，也需要在 <code>AndroidManifest.xml</code> 中声明:</p>
<pre><code class="hljs">&lt;activity android:name=&quot;com.facebook.react.devsupport.DevSettingsActivity&quot; /&gt;
</code></pre>
<p>This is only really used in dev mode when reloading JavaScript from the development server, so you can strip this in release builds if you need to.</p>
<h2><a class="anchor" aria-hidden="true" id="添加原生代码"></a><a href="#添加原生代码" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>添加原生代码</h2>
<p>想要通过原生代码调用 React Native ，就像这样，我们需要在一个 <code>Activity</code> 中创建一个 <code>ReactRootView</code> 对象，将它关联一个 React application 并设为界面的主视图。</p>
<blockquote>
<p>如果你想在安卓 5.0 以下的系统上运行，请用 <code>com.android.support:appcompat</code> 包中的 <code>AppCompatActivity</code> 代替 <code>Activity</code> 。</p>
</blockquote>
<pre><code class="hljs css language-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyReactActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Activity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">DefaultHardwareBackBtnHandler</span> </span>{
    <span class="hljs-keyword">private</span> ReactRootView mReactRootView;
    <span class="hljs-keyword">private</span> ReactInstanceManager mReactInstanceManager;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> </span>{
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);

        mReactRootView = <span class="hljs-keyword">new</span> ReactRootView(<span class="hljs-keyword">this</span>);
        mReactInstanceManager = ReactInstanceManager.builder()
                .setApplication(getApplication())
                .setBundleAssetName(<span class="hljs-string">"index.android.bundle"</span>)
                .setJSMainModuleName(<span class="hljs-string">"index.android"</span>)
                .addPackage(<span class="hljs-keyword">new</span> MainReactPackage())
                .setUseDeveloperSupport(BuildConfig.DEBUG)
                .setInitialLifecycleState(LifecycleState.RESUMED)
                .build();

        <span class="hljs-comment">// 注意这里的HelloWorld必须对应“index.android.js”中的</span>
        <span class="hljs-comment">// “AppRegistry.registerComponent()”的第一个参数</span>
        mReactRootView.startReactApplication(mReactInstanceManager, <span class="hljs-string">"HelloWorld"</span>, <span class="hljs-keyword">null</span>);

        setContentView(mReactRootView);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">invokeDefaultOnBackPressed</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">super</span>.onBackPressed();
    }
}
</code></pre>
<blockquote>
<p>如果你的项目名字不是叫“HelloWorld”，则需要将“index.android.js”中的“AppRegistry.registerComponent()”方法中的第一个参数替换为对应的名字。</p>
</blockquote>
<p>如果你使用的是 Android Studio , 可以使用<code>Alt + Enter</code>快捷键来自动为 MyReactActivity 类补上缺失的 import 语句。注意引入的<code>BuildConfig</code>应该是在你自己的包中，而不是在<code>...facebook...</code>的包中。</p>
<p>我们需要把 <code>MyReactActivity</code> 的主题设定为 <code>Theme.AppCompat.Light.NoActionBar</code> ，因为里面有许多组件都使用了这一主题。</p>
<pre><code class="hljs css language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">activity</span>
  <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MyReactActivity"</span>
  <span class="hljs-attr">android:label</span>=<span class="hljs-string">"@string/app_name"</span>
  <span class="hljs-attr">android:theme</span>=<span class="hljs-string">"@style/Theme.AppCompat.Light.NoActionBar"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span>
</code></pre>
<blockquote>
<p>一个<code>ReactInstanceManager</code>可以在多个 activities 或 fragments 间共享。 You will want to make your own <code>ReactFragment</code> or <code>ReactActivity</code> and have a singleton <em>holder</em> that holds a <code>ReactInstanceManager</code>. When you need the <code>ReactInstanceManager</code> (e.g., to hook up the <code>ReactInstanceManager</code> to the lifecycle of those Activities or Fragments) use the one provided by the singleton.</p>
</blockquote>
<p>下一步我们需要把一些 activity 的生命周期回调传递给<code>ReactInstanceManager</code>：</p>
<pre><code class="hljs css language-java"><span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onPause</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">super</span>.onPause();

    <span class="hljs-keyword">if</span> (mReactInstanceManager != <span class="hljs-keyword">null</span>) {
        mReactInstanceManager.onHostPause(<span class="hljs-keyword">this</span>);
    }
}

<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onResume</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">super</span>.onResume();

    <span class="hljs-keyword">if</span> (mReactInstanceManager != <span class="hljs-keyword">null</span>) {
        mReactInstanceManager.onHostResume(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>);
    }
}

<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">super</span>.onDestroy();

    <span class="hljs-keyword">if</span> (mReactInstanceManager != <span class="hljs-keyword">null</span>) {
        mReactInstanceManager.onHostDestroy();
    }
}
</code></pre>
<p>We also need to pass back button events to React Native:</p>
<pre><code class="hljs css language-java"><span class="hljs-meta">@Override</span>
 <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onBackPressed</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">if</span> (mReactInstanceManager != <span class="hljs-keyword">null</span>) {
        mReactInstanceManager.onBackPressed();
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">super</span>.onBackPressed();
    }
}
</code></pre>
<p>This allows JavaScript to control what happens when the user presses the hardware back button (e.g. to implement navigation). When JavaScript doesn't handle a back press, your <code>invokeDefaultOnBackPressed</code> method will be called. By default this simply finishes your <code>Activity</code>.</p>
<p>Finally, we need to hook up the dev menu. By default, this is activated by (rage) shaking the device, but this is not very useful in emulators. So we make it show when you press the hardware menu button (use <code>Ctrl + M</code> if you're using Android Studio emulator):</p>
<pre><code class="hljs css language-java"><span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">onKeyUp</span><span class="hljs-params">(<span class="hljs-keyword">int</span> keyCode, KeyEvent event)</span> </span>{
    <span class="hljs-keyword">if</span> (keyCode == KeyEvent.KEYCODE_MENU &amp;&amp; mReactInstanceManager != <span class="hljs-keyword">null</span>) {
        mReactInstanceManager.showDevOptionsDialog();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onKeyUp(keyCode, event);
}
</code></pre>
<p>现在 activity 已就绪，可以运行一些 JavaScript 代码了。</p>
<h3><a class="anchor" aria-hidden="true" id="配置权限以便开发中的红屏错误能正确显示"></a><a href="#配置权限以便开发中的红屏错误能正确显示" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>配置权限以便开发中的红屏错误能正确显示</h3>
<p>如果你的应用会运行在 Android 6.0（API level 23）或更高版本，请确保你在开发版本中有打开<code>悬浮窗(overlay)</code>权限。If your app is targeting the Android <code>API level 23</code> or greater, make sure you have the <code>overlay</code> permission enabled for the development build. You can check it with <code>Settings.canDrawOverlays(this);</code>. This is required in dev builds because react native development errors must be displayed above all the other windows. Due to the new permissions system introduced in the API level 23, the user needs to approve it. This can be acheived by adding the following code to the Activity file in the onCreate() method. OVERLAY_PERMISSION_REQ_CODE is a field of the class which would be responsible for passing the result back to the Activity.</p>
<pre><code class="hljs css language-java"><span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) {
    <span class="hljs-keyword">if</span> (!Settings.canDrawOverlays(<span class="hljs-keyword">this</span>)) {
        Intent intent = <span class="hljs-keyword">new</span> Intent(Settings.ACTION_MANAGE_OVERLAY_PERMISSION,
                                   Uri.parse(<span class="hljs-string">"package:"</span> + getPackageName()));
        startActivityForResult(intent, OVERLAY_PERMISSION_REQ_CODE);
    }
}
</code></pre>
<p>Finally, the <code>onActivityResult()</code> method (as shown in the code below) has to be overridden to handle the permission Accepted or Denied cases for consistent UX.</p>
<pre><code class="hljs css language-java"><span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onActivityResult</span><span class="hljs-params">(<span class="hljs-keyword">int</span> requestCode, <span class="hljs-keyword">int</span> resultCode, Intent data)</span> </span>{
    <span class="hljs-keyword">if</span> (requestCode == OVERLAY_PERMISSION_REQ_CODE) {
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) {
            <span class="hljs-keyword">if</span> (!Settings.canDrawOverlays(<span class="hljs-keyword">this</span>)) {
                <span class="hljs-comment">// SYSTEM_ALERT_WINDOW permission not granted...</span>
            }
        }
    }
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="运行你的应用"></a><a href="#运行你的应用" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>运行你的应用</h2>
<p>运行应用首先需要启动开发服务器（Packager）。你只需在项目根目录中执行以下命令即可：</p>
<pre><code class="hljs">$ npm start
</code></pre>
<p>保持 packager 的窗口运行不要关闭，然后像往常一样编译运行你的 Android 应用(在命令行中执行<code>./gradlew installDebug</code>或是在 Android Studio 中编译运行)。</p>
<blockquote>
<p>如果你是使用 Android Studio 来编译运行，有可能会导致 packger 报错退出。这种情况下你需要安装<a href="https://facebook.github.io/watchman/">watchman</a>。但是 watchman 目前没有稳定的 Windows 版本，所以在 Windows 下这种崩溃情况暂时没有特别好的解决方案。</p>
</blockquote>
<p>编译执行一切顺利进行之后，在进入到 MyReactActivity 时应该就能立刻从 packager 中读取 JavaScript 代码并执行和显示：</p>
<p><img src="/img/EmbeddedAppAndroid.png" alt="Screenshot"></p>
<h2><a class="anchor" aria-hidden="true" id="在-android-studio-中打包"></a><a href="#在-android-studio-中打包" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>在 Android Studio 中打包</h2>
<p>你也可以使用 Android Studio 来打 release 包！其步骤基本和原生应用一样，只是在每次编译打包之前需要先执行 js 文件的打包(即生成离线的 jsbundle 文件)。具体的 js 打包命令如下：</p>
<pre><code class="hljs">$ react-native bundle --platform android --dev false --entry-file index.android.js --bundle-output android/com/your-company-name/app-package-name/src/main/assets/index.android.bundle --assets-dest android/com/your-company-name/app-package-name/src/main/res/
</code></pre>
<p>注意把上述命令中的路径替换为你实际项目的路径。如果 assets 目录不存在，需要提前自己创建一个。</p>
<p>然后在 Android Studio 中正常生成 release 版本即可！</p>
</div>
<script>
window.display = function (type, value) {
  var container = document.querySelector('.md-block').parentNode;
  container.className = 'display-' + type + '-' + value + ' ' +
    container.className.replace(RegExp('display-' + type + '-[a-z]+ ?'), '');
}
// If we are coming to the page with a hash in it (i.e. from a search, for example), try to get
// us as close as possible to the correct platform and dev os using the hashtag and block walk up.
var foundHash = false;
if (window.location.hash !== '' && window.location.hash !== 'content') { // content is default
  var hashLinks = document.querySelectorAll('a.hash-link');
  for (var i = 0; i < hashLinks.length && !foundHash; ++i) {
    if (hashLinks[i].hash === window.location.hash) {
      var parent = hashLinks[i].parentElement;
      while (parent) {
        if (parent.tagName === 'BLOCK') {
          var targetPlatform = null;
          // Could be more than one target platform, but just choose some sort of order
          // of priority here.
          // Target Platform
          if (parent.className.indexOf('objc') > -1) {
            targetPlatform = 'objc';
          } else if (parent.className.indexOf('swift') > -1) {
            targetPlatform = 'swift';
          } else if (parent.className.indexOf('android') > -1) {
            targetPlatform = 'android';
          } else {
            break; // assume we don't have anything.
          }
          // We would have broken out if both targetPlatform and devOS hadn't been filled.
          display('platform', targetPlatform);
          foundHash = true;
          break;
        }
        parent = parent.parentElement;
      }
    }
  }
}
// Do the default if there is no matching hash
if (!foundHash) {
  var isMac = navigator.platform === 'MacIntel';
  display('platform', isMac ? 'objc' : 'android');
}
</script>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/react-native-website/docs/0.43/more-resources"><span class="arrow-prev">← </span><span>其他参考资源</span></a><a class="docs-next button" href="/react-native-website/docs/0.43/colors"><span>颜色</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#核心概念">核心概念</a></li><li><a href="#开发环境准备">开发环境准备</a><ul class="toc-headings"><li><a href="#基础环境">基础环境</a></li><li><a href="#cocoapods">CocoaPods</a></li></ul></li><li><a href="#示例-app">示例 App</a></li><li><a href="#依赖包">依赖包</a><ul class="toc-headings"><li><a href="#packagejson"><code>package.json</code></a></li><li><a href="#安装依赖包">安装依赖包</a></li></ul></li><li><a href="#react-native-框架">React Native 框架</a><ul class="toc-headings"><li><a href="#subspecs">Subspecs</a></li></ul></li><li><a href="#代码集成">代码集成</a><ul class="toc-headings"><li><a href="#react-native-组件">React Native 组件</a></li></ul></li><li><a href="#the-magic-rctrootview">The Magic: <code>RCTRootView</code></a><ul class="toc-headings"><li><a href="#create-an-event-path">Create an Event Path</a></li></ul></li><li><a href="#测试植入结果">测试植入结果</a><ul class="toc-headings"><li><a href="#app-transport-security">App Transport Security</a></li><li><a href="#运行-packager">运行 Packager</a></li><li><a href="#运行应用">运行应用</a></li><li><a href="#看一下完整的代码变更">看一下完整的代码变更</a></li></ul></li><li><a href="#在应用中添加-js-代码">在应用中添加 JS 代码</a></li><li><a href="#准备工作">准备工作</a></li><li><a href="#添加原生代码">添加原生代码</a><ul class="toc-headings"><li><a href="#配置权限以便开发中的红屏错误能正确显示">配置权限以便开发中的红屏错误能正确显示</a></li></ul></li><li><a href="#运行你的应用">运行你的应用</a></li><li><a href="#在-android-studio-中打包">在 Android Studio 中打包</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright"><p style="color:inherit">React Native中文网 © 2020 杭州欧石南网络科技有限公司</p><p style="color:inherit"><a href="http://beian.miit.gov.cn/">浙ICP备15023664号-3</a><img src="https://img.alicdn.com/tfs/TB1..50QpXXXXX7XpXXXXXXXXXX-40-40.png" alt="浙公网安备 33010602005511号"/><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33010602005511">浙公网安备 33010602005511号</a></p></section><script>
        (function(){
          var c = document.createElement("div");
          c.setAttribute("id", "lv-container");
          c.setAttribute("data-id", "city");
          c.setAttribute("data-uid", "MTAyMC8zODM4NS8xNDkxMw==");
          var container = document.querySelector(".mainContainer")
          container && container.appendChild(c);
        })()
        </script><script src="https://cdn-city.livere.com/js/embed.dist.js"></script></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '7ab53ed26928639bae06ef0f6165f68b',
                indexName: 'reactnative_cn',
                inputSelector: '#search_input_react',
                algoliaOptions: {"hitsPerPage":5}
              });
            </script></body></html>